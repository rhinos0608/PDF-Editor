217f5a90da81bc071aa4ce5ffd3254a6
"use strict";
/**
 * Unit tests for PDFService
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// Mock external dependencies
jest.mock('pdfjs-dist', () => ({
    GlobalWorkerOptions: {
        workerSrc: ''
    },
    getDocument: jest.fn()
}));
jest.mock('pdf-lib', () => ({
    PDFDocument: {
        create: jest.fn(),
        load: jest.fn()
    },
    rgb: jest.fn(() => ({ r: 1, g: 0, b: 0 })),
    StandardFonts: {
        Helvetica: 'Helvetica'
    },
    degrees: jest.fn((deg) => deg * Math.PI / 180)
}));
// Mock common utils
jest.mock('../../../src/common/utils', () => ({
    loadPDFSafely: jest.fn(),
    validatePDFBytes: jest.fn(() => true),
    createSafePDFBytes: jest.fn((bytes) => new Uint8Array(bytes))
}));
const PDFService_1 = require("../../../src/renderer/services/PDFService");
const pdf_lib_1 = require("pdf-lib");
const pdfjsLib = __importStar(require("pdfjs-dist"));
describe('PDFService', () => {
    let pdfService;
    let mockPDFDocument;
    beforeEach(() => {
        pdfService = new PDFService_1.PDFService();
        // Create mock PDF document
        mockPDFDocument = {
            save: jest.fn().mockResolvedValue(new Uint8Array([1, 2, 3, 4])),
            getPageCount: jest.fn().mockReturnValue(5),
            addPage: jest.fn(),
            removePage: jest.fn(),
            getPages: jest.fn().mockReturnValue([]),
            getTitle: jest.fn().mockReturnValue('Test PDF'),
            setTitle: jest.fn(),
            getAuthor: jest.fn().mockReturnValue('Test Author'),
            setAuthor: jest.fn(),
            getSubject: jest.fn().mockReturnValue('Test Subject'),
            setSubject: jest.fn(),
            getKeywords: jest.fn().mockReturnValue(['test', 'pdf']),
            setKeywords: jest.fn(),
            getCreator: jest.fn().mockReturnValue('Test Creator'),
            setCreator: jest.fn(),
            getProducer: jest.fn().mockReturnValue('Test Producer'),
            setProducer: jest.fn(),
            getCreationDate: jest.fn().mockReturnValue(new Date('2024-01-01')),
            setCreationDate: jest.fn(),
            getModificationDate: jest.fn().mockReturnValue(new Date('2024-01-02')),
            setModificationDate: jest.fn()
        };
        jest.clearAllMocks();
    });
    describe('Constructor', () => {
        it('should initialize with empty state', () => {
            const service = new PDFService_1.PDFService();
            expect(() => service.getCurrentPDF()).toThrow('No PDF document is currently loaded');
        });
        it('should warn if PDF.js worker is not configured', () => {
            const consoleSpy = jest.spyOn(console, 'warn').mockImplementation();
            pdfjsLib.GlobalWorkerOptions.workerSrc = '';
            new PDFService_1.PDFService();
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('PDF.js worker not configured'));
            consoleSpy.mockRestore();
        });
    });
    describe('setCurrentPDF', () => {
        it('should set current PDF with safe bytes', () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(pdfService.getCurrentPDF()).toBe(mockPDFDocument);
            expect(pdfService.hasUnsavedChanges()).toBe(false);
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('Current PDF set with safe byte tracking'));
            consoleSpy.mockRestore();
        });
        it('should create safe copy of original bytes', () => {
            const { createSafePDFBytes } = require('../../../src/common/utils');
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(createSafePDFBytes).toHaveBeenCalledWith(originalBytes);
        });
    });
    describe('getCurrentPDF', () => {
        it('should return current PDF when set', () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(pdfService.getCurrentPDF()).toBe(mockPDFDocument);
        });
        it('should throw error when no PDF is loaded', () => {
            expect(() => pdfService.getCurrentPDF()).toThrow('No PDF document is currently loaded');
        });
    });
    describe('markModified', () => {
        it('should mark PDF as modified', () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(pdfService.hasUnsavedChanges()).toBe(false);
            pdfService.markModified();
            expect(pdfService.hasUnsavedChanges()).toBe(true);
        });
    });
    describe('saveCurrentPDF', () => {
        it('should save current PDF and return bytes', async () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const savedBytes = new Uint8Array([5, 4, 3, 2, 1]);
            mockPDFDocument.save.mockResolvedValue(savedBytes);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            const result = await pdfService.saveCurrentPDF();
            expect(mockPDFDocument.save).toHaveBeenCalled();
            expect(result).toEqual(savedBytes);
            expect(pdfService.hasUnsavedChanges()).toBe(false); // Should reset modified flag
        });
        it('should throw error when no PDF is loaded', async () => {
            await expect(pdfService.saveCurrentPDF()).rejects.toThrow('No PDF document to save');
        });
        it('should handle save errors gracefully', async () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const saveError = new Error('Save failed');
            // Set originalBytes before calling saveCurrentPDF to enable recovery logic
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            // Mock save to always reject with the saveError
            mockPDFDocument.save.mockImplementation(() => {
                throw saveError;
            });
            await expect(pdfService.saveCurrentPDF()).rejects.toThrow(expect.stringContaining('Failed to save PDF after 3 attempts: Save failed'));
        });
    });
    describe('loadPDF', () => {
        it('should load PDF from bytes', async () => {
            const { loadPDFSafely } = require('../../../src/common/utils');
            const mockPDFProxy = { numPages: 3 };
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            loadPDFSafely.mockResolvedValue(mockPDFProxy);
            const result = await pdfService.loadPDF(pdfBytes);
            expect(loadPDFSafely).toHaveBeenCalledWith(pdfBytes, undefined);
            expect(result).toBe(mockPDFProxy);
        });
        it('should pass options to loadPDFSafely', async () => {
            const { loadPDFSafely } = require('../../../src/common/utils');
            const mockPDFProxy = { numPages: 3 };
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const options = { verbosity: 1 };
            loadPDFSafely.mockResolvedValue(mockPDFProxy);
            await pdfService.loadPDF(pdfBytes, options);
            expect(loadPDFSafely).toHaveBeenCalledWith(pdfBytes, options);
        });
        it('should handle loading errors', async () => {
            const { loadPDFSafely } = require('../../../src/common/utils');
            const loadError = new Error('Load failed');
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            loadPDFSafely.mockRejectedValue(loadError);
            await expect(pdfService.loadPDF(pdfBytes)).rejects.toThrow('Load failed');
        });
    });
    describe('createPDF', () => {
        it('should create new empty PDF document', async () => {
            const mockNewDoc = { ...mockPDFDocument };
            pdf_lib_1.PDFDocument.create.mockResolvedValue(mockNewDoc);
            const result = await pdfService.createPDF();
            expect(pdf_lib_1.PDFDocument.create).toHaveBeenCalled();
            expect(result).toBe(mockNewDoc);
        });
        it('should handle creation errors', async () => {
            const createError = new Error('Creation failed');
            pdf_lib_1.PDFDocument.create.mockRejectedValue(createError);
            await expect(pdfService.createPDF()).rejects.toThrow('Creation failed');
        });
    });
    describe('mergePDFs', () => {
        it('should merge multiple PDF buffers', async () => {
            const pdfBuffer1 = new Uint8Array([1, 2, 3]);
            const pdfBuffer2 = new Uint8Array([4, 5, 6]);
            const pdfBuffers = [pdfBuffer1, pdfBuffer2];
            const mockDoc1 = { ...mockPDFDocument, getPageCount: () => 2, getPages: () => ['page1', 'page2'] };
            const mockDoc2 = { ...mockPDFDocument, getPageCount: () => 1, getPages: () => ['page3'] };
            const mockMergedDoc = {
                ...mockPDFDocument,
                copyPages: jest.fn().mockResolvedValue(['copiedPage1', 'copiedPage2', 'copiedPage3']),
                addPage: jest.fn()
            };
            pdf_lib_1.PDFDocument.load
                .mockResolvedValueOnce(mockDoc1)
                .mockResolvedValueOnce(mockDoc2);
            pdf_lib_1.PDFDocument.create.mockResolvedValue(mockMergedDoc);
            const mergedBytes = new Uint8Array([1, 2, 3, 4, 5, 6]);
            mockMergedDoc.save.mockResolvedValue(mergedBytes);
            const result = await pdfService.mergePDFs(pdfBuffers);
            expect(pdf_lib_1.PDFDocument.load).toHaveBeenCalledTimes(2);
            expect(pdf_lib_1.PDFDocument.create).toHaveBeenCalled();
            expect(mockMergedDoc.copyPages).toHaveBeenCalledTimes(2);
            expect(result).toBe(mergedBytes);
        });
        it('should handle merge errors', async () => {
            const pdfBuffers = [new Uint8Array([1, 2, 3])];
            const loadError = new Error('Load failed');
            pdf_lib_1.PDFDocument.load.mockRejectedValue(loadError);
            await expect(pdfService.mergePDFs(pdfBuffers)).rejects.toThrow('Load failed');
        });
        it('should handle empty buffers array', async () => {
            await expect(pdfService.mergePDFs([])).rejects.toThrow();
        });
    });
    describe('splitPDF', () => {
        it('should split PDF at specified page', async () => {
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const splitPage = 3;
            const mockSourceDoc = {
                ...mockPDFDocument,
                getPageCount: () => 5,
                getPages: () => ['p1', 'p2', 'p3', 'p4', 'p5']
            };
            const mockFirstDoc = {
                ...mockPDFDocument,
                copyPages: jest.fn().mockResolvedValue(['p1', 'p2', 'p3']),
                addPage: jest.fn(),
                save: jest.fn().mockResolvedValue(new Uint8Array([1, 2, 3]))
            };
            const mockSecondDoc = {
                ...mockPDFDocument,
                copyPages: jest.fn().mockResolvedValue(['p4', 'p5']),
                addPage: jest.fn(),
                save: jest.fn().mockResolvedValue(new Uint8Array([4, 5]))
            };
            pdf_lib_1.PDFDocument.load.mockResolvedValue(mockSourceDoc);
            pdf_lib_1.PDFDocument.create
                .mockResolvedValueOnce(mockFirstDoc)
                .mockResolvedValueOnce(mockSecondDoc);
            const result = await pdfService.splitPDF(pdfBytes, splitPage);
            expect(result.first).toEqual(new Uint8Array([1, 2, 3]));
            expect(result.second).toEqual(new Uint8Array([4, 5]));
        });
        it('should handle invalid split page', async () => {
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const mockSourceDoc = { getPageCount: () => 5 };
            pdf_lib_1.PDFDocument.load.mockResolvedValue(mockSourceDoc);
            await expect(pdfService.splitPDF(pdfBytes, 0)).rejects.toThrow('Invalid split page');
            await expect(pdfService.splitPDF(pdfBytes, 6)).rejects.toThrow('Invalid split page');
        });
    });
});
// Clean up after tests
afterAll(() => {
    jest.restoreAllMocks();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBZG1pblxcRG9jdW1lbnRzXFxSU1RcXFBERiBFZGl0b3JcXF9fdGVzdHNfX1xccmVuZGVyZXJcXHNlcnZpY2VzXFxQREZTZXJ2aWNlLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU1ILDZCQUE2QjtBQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzdCLG1CQUFtQixFQUFFO1FBQ25CLFNBQVMsRUFBRSxFQUFFO0tBQ2Q7SUFDRCxXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN2QixDQUFDLENBQUMsQ0FBQztBQUVKLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDMUIsV0FBVyxFQUFFO1FBQ1gsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDaEI7SUFDRCxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLGFBQWEsRUFBRTtRQUNiLFNBQVMsRUFBRSxXQUFXO0tBQ3ZCO0lBQ0QsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQztDQUN2RCxDQUFDLENBQUMsQ0FBQztBQUVKLG9CQUFvQjtBQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDNUMsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDeEIsZ0JBQWdCLEVBQUUsSUFB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QUU7WUFDaEQsTUFBTSxRQUFRLEdBQUcsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqRCxNQUFNLGFBQWEsR0FBRyxFQUFFLFlBQVksRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUUvQyxxQkFBVyxDQUFDLElBQWtCLENBQUMsaUJBQWlCLENBQUMsYUFBYSxDQUFDLENBQUM7WUFFakUsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUM7WUFDckYsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDdkYsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsdUJBQXVCO0FBQ3ZCLFFBQVEsQ0FBQyxHQUFHLEVBQUU7SUFDWixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDekIsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBZG1pblxcRG9jdW1lbnRzXFxSU1RcXFBERiBFZGl0b3JcXF9fdGVzdHNfX1xccmVuZGVyZXJcXHNlcnZpY2VzXFxQREZTZXJ2aWNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IHRlc3RzIGZvciBQREZTZXJ2aWNlXG4gKi9cblxuaW1wb3J0IHsgUERGU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL3NyYy9yZW5kZXJlci9zZXJ2aWNlcy9QREZTZXJ2aWNlJztcbmltcG9ydCB7IFBERkRvY3VtZW50IH0gZnJvbSAncGRmLWxpYic7XG5pbXBvcnQgKiBhcyBwZGZqc0xpYiBmcm9tICdwZGZqcy1kaXN0JztcblxuLy8gTW9jayBleHRlcm5hbCBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygncGRmanMtZGlzdCcsICgpID0+ICh7XG4gIEdsb2JhbFdvcmtlck9wdGlvbnM6IHtcbiAgICB3b3JrZXJTcmM6ICcnXG4gIH0sXG4gIGdldERvY3VtZW50OiBqZXN0LmZuKClcbn0pKTtcblxuamVzdC5tb2NrKCdwZGYtbGliJywgKCkgPT4gKHtcbiAgUERGRG9jdW1lbnQ6IHtcbiAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICBsb2FkOiBqZXN0LmZuKClcbiAgfSxcbiAgcmdiOiBqZXN0LmZuKCgpID0+ICh7IHI6IDEsIGc6IDAsIGI6IDAgfSkpLFxuICBTdGFuZGFyZEZvbnRzOiB7XG4gICAgSGVsdmV0aWNhOiAnSGVsdmV0aWNhJ1xuICB9LFxuICBkZWdyZWVzOiBqZXN0LmZuKChkZWc6IG51bWJlcikgPT4gZGVnICogTWF0aC5QSSAvIDE4MClcbn0pKTtcblxuLy8gTW9jayBjb21tb24gdXRpbHNcbmplc3QubW9jaygnLi4vLi4vLi4vc3JjL2NvbW1vbi91dGlscycsICgpID0+ICh7XG4gIGxvYWRQREZTYWZlbHk6IGplc3QuZm4oKSxcbiAgdmFsaWRhdGVQREZCeXRlczogamVzdC5mbigoKSA9PiB0cnVlKSxcbiAgY3JlYXRlU2FmZVBERkJ5dGVzOiBqZXN0LmZuKChieXRlczogVWludDhBcnJheSkgPT4gbmV3IFVpbnQ4QXJyYXkoYnl0ZXMpKVxufSkpO1xuXG5kZXNjcmliZSgnUERGU2VydmljZScsICgpID0+IHtcbiAgbGV0IHBkZlNlcnZpY2U6IFBERlNlcnZpY2U7XG4gIGxldCBtb2NrUERGRG9jdW1lbnQ6IGplc3QuTW9ja2VkPFBERkRvY3VtZW50PjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBwZGZTZXJ2aWNlID0gbmV3IFBERlNlcnZpY2UoKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgbW9jayBQREYgZG9jdW1lbnRcbiAgICBtb2NrUERGRG9jdW1lbnQgPSB7XG4gICAgICBzYXZlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDRdKSksXG4gICAgICBnZXRQYWdlQ291bnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoNSksXG4gICAgICBhZGRQYWdlOiBqZXN0LmZuKCksXG4gICAgICByZW1vdmVQYWdlOiBqZXN0LmZuKCksXG4gICAgICBnZXRQYWdlczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShbXSksXG4gICAgICBnZXRUaXRsZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBQREYnKSxcbiAgICAgIHNldFRpdGxlOiBqZXN0LmZuKCksXG4gICAgICBnZXRBdXRob3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3QgQXV0aG9yJyksXG4gICAgICBzZXRBdXRob3I6IGplc3QuZm4oKSxcbiAgICAgIGdldFN1YmplY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3QgU3ViamVjdCcpLFxuICAgICAgc2V0U3ViamVjdDogamVzdC5mbigpLFxuICAgICAgZ2V0S2V5d29yZHM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoWyd0ZXN0JywgJ3BkZiddKSxcbiAgICAgIHNldEtleXdvcmRzOiBqZXN0LmZuKCksXG4gICAgICBnZXRDcmVhdG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdUZXN0IENyZWF0b3InKSxcbiAgICAgIHNldENyZWF0b3I6IGplc3QuZm4oKSxcbiAgICAgIGdldFByb2R1Y2VyOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdUZXN0IFByb2R1Y2VyJyksXG4gICAgICBzZXRQcm9kdWNlcjogamVzdC5mbigpLFxuICAgICAgZ2V0Q3JlYXRpb25EYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG5ldyBEYXRlKCcyMDI0LTAxLTAxJykpLFxuICAgICAgc2V0Q3JlYXRpb25EYXRlOiBqZXN0LmZuKCksXG4gICAgICBnZXRNb2RpZmljYXRpb25EYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKG5ldyBEYXRlKCcyMDI0LTAxLTAyJykpLFxuICAgICAgc2V0TW9kaWZpY2F0aW9uRGF0ZTogamVzdC5mbigpXG4gICAgfSBhcyBhbnk7XG5cbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbnN0cnVjdG9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIGVtcHR5IHN0YXRlJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZSA9IG5ldyBQREZTZXJ2aWNlKCk7XG4gICAgICBleHBlY3QoKCkgPT4gc2VydmljZS5nZXRDdXJyZW50UERGKCkpLnRvVGhyb3coJ05vIFBERiBkb2N1bWVudCBpcyBjdXJyZW50bHkgbG9hZGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHdhcm4gaWYgUERGLmpzIHdvcmtlciBpcyBub3QgY29uZmlndXJlZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICd3YXJuJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgICAocGRmanNMaWIuR2xvYmFsV29ya2VyT3B0aW9ucyBhcyBhbnkpLndvcmtlclNyYyA9ICcnO1xuICAgICAgXG4gICAgICBuZXcgUERGU2VydmljZSgpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ1BERi5qcyB3b3JrZXIgbm90IGNvbmZpZ3VyZWQnKSk7XG4gICAgICBjb25zb2xlU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZXRDdXJyZW50UERGJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2V0IGN1cnJlbnQgUERGIHdpdGggc2FmZSBieXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgY29uc3QgY29uc29sZVNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgICBwZGZTZXJ2aWNlLnNldEN1cnJlbnRQREYobW9ja1BERkRvY3VtZW50LCBvcmlnaW5hbEJ5dGVzKTtcblxuICAgICAgZXhwZWN0KHBkZlNlcnZpY2UuZ2V0Q3VycmVudFBERigpKS50b0JlKG1vY2tQREZEb2N1bWVudCk7XG4gICAgICBleHBlY3QocGRmU2VydmljZS5oYXNVbnNhdmVkQ2hhbmdlcygpKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Quc3RyaW5nQ29udGFpbmluZygnQ3VycmVudCBQREYgc2V0IHdpdGggc2FmZSBieXRlIHRyYWNraW5nJykpO1xuICAgICAgXG4gICAgICBjb25zb2xlU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBzYWZlIGNvcHkgb2Ygb3JpZ2luYWwgYnl0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IGNyZWF0ZVNhZmVQREZCeXRlcyB9ID0gcmVxdWlyZSgnLi4vLi4vLi4vc3JjL2NvbW1vbi91dGlscycpO1xuICAgICAgY29uc3Qgb3JpZ2luYWxCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG5cbiAgICAgIHBkZlNlcnZpY2Uuc2V0Q3VycmVudFBERihtb2NrUERGRG9jdW1lbnQsIG9yaWdpbmFsQnl0ZXMpO1xuXG4gICAgICBleHBlY3QoY3JlYXRlU2FmZVBERkJ5dGVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChvcmlnaW5hbEJ5dGVzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEN1cnJlbnRQREYnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY3VycmVudCBQREYgd2hlbiBzZXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcmlnaW5hbEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIHBkZlNlcnZpY2Uuc2V0Q3VycmVudFBERihtb2NrUERGRG9jdW1lbnQsIG9yaWdpbmFsQnl0ZXMpO1xuXG4gICAgICBleHBlY3QocGRmU2VydmljZS5nZXRDdXJyZW50UERGKCkpLnRvQmUobW9ja1BERkRvY3VtZW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBubyBQREYgaXMgbG9hZGVkJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KCgpID0+IHBkZlNlcnZpY2UuZ2V0Q3VycmVudFBERigpKS50b1Rocm93KCdObyBQREYgZG9jdW1lbnQgaXMgY3VycmVudGx5IGxvYWRlZCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbWFya01vZGlmaWVkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbWFyayBQREYgYXMgbW9kaWZpZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcmlnaW5hbEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIHBkZlNlcnZpY2Uuc2V0Q3VycmVudFBERihtb2NrUERGRG9jdW1lbnQsIG9yaWdpbmFsQnl0ZXMpO1xuXG4gICAgICBleHBlY3QocGRmU2VydmljZS5oYXNVbnNhdmVkQ2hhbmdlcygpKS50b0JlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgcGRmU2VydmljZS5tYXJrTW9kaWZpZWQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHBkZlNlcnZpY2UuaGFzVW5zYXZlZENoYW5nZXMoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NhdmVDdXJyZW50UERGJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2F2ZSBjdXJyZW50IFBERiBhbmQgcmV0dXJuIGJ5dGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luYWxCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBjb25zdCBzYXZlZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzUsIDQsIDMsIDIsIDFdKTtcbiAgICAgIFxuICAgICAgbW9ja1BERkRvY3VtZW50LnNhdmUubW9ja1Jlc29sdmVkVmFsdWUoc2F2ZWRCeXRlcyk7XG4gICAgICBwZGZTZXJ2aWNlLnNldEN1cnJlbnRQREYobW9ja1BERkRvY3VtZW50LCBvcmlnaW5hbEJ5dGVzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGRmU2VydmljZS5zYXZlQ3VycmVudFBERigpO1xuXG4gICAgICBleHBlY3QobW9ja1BERkRvY3VtZW50LnNhdmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoc2F2ZWRCeXRlcyk7XG4gICAgICBleHBlY3QocGRmU2VydmljZS5oYXNVbnNhdmVkQ2hhbmdlcygpKS50b0JlKGZhbHNlKTsgLy8gU2hvdWxkIHJlc2V0IG1vZGlmaWVkIGZsYWdcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBubyBQREYgaXMgbG9hZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZXhwZWN0KHBkZlNlcnZpY2Uuc2F2ZUN1cnJlbnRQREYoKSkucmVqZWN0cy50b1Rocm93KCdObyBQREYgZG9jdW1lbnQgdG8gc2F2ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2F2ZSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgY29uc3Qgc2F2ZUVycm9yID0gbmV3IEVycm9yKCdTYXZlIGZhaWxlZCcpO1xuICAgICAgXG4gICAgICAvLyBTZXQgb3JpZ2luYWxCeXRlcyBiZWZvcmUgY2FsbGluZyBzYXZlQ3VycmVudFBERiB0byBlbmFibGUgcmVjb3ZlcnkgbG9naWNcbiAgICAgIHBkZlNlcnZpY2Uuc2V0Q3VycmVudFBERihtb2NrUERGRG9jdW1lbnQsIG9yaWdpbmFsQnl0ZXMpO1xuICAgICAgLy8gTW9jayBzYXZlIHRvIGFsd2F5cyByZWplY3Qgd2l0aCB0aGUgc2F2ZUVycm9yXG4gICAgICBtb2NrUERGRG9jdW1lbnQuc2F2ZS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBzYXZlRXJyb3I7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHBkZlNlcnZpY2Uuc2F2ZUN1cnJlbnRQREYoKSkucmVqZWN0cy50b1Rocm93KGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdGYWlsZWQgdG8gc2F2ZSBQREYgYWZ0ZXIgMyBhdHRlbXB0czogU2F2ZSBmYWlsZWQnKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdsb2FkUERGJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbG9hZCBQREYgZnJvbSBieXRlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbG9hZFBERlNhZmVseSB9ID0gcmVxdWlyZSgnLi4vLi4vLi4vc3JjL2NvbW1vbi91dGlscycpO1xuICAgICAgY29uc3QgbW9ja1BERlByb3h5ID0geyBudW1QYWdlczogMyB9O1xuICAgICAgY29uc3QgcGRmQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgXG4gICAgICBsb2FkUERGU2FmZWx5Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQREZQcm94eSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBkZlNlcnZpY2UubG9hZFBERihwZGZCeXRlcyk7XG5cbiAgICAgIGV4cGVjdChsb2FkUERGU2FmZWx5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwZGZCeXRlcywgdW5kZWZpbmVkKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUobW9ja1BERlByb3h5KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcGFzcyBvcHRpb25zIHRvIGxvYWRQREZTYWZlbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IGxvYWRQREZTYWZlbHkgfSA9IHJlcXVpcmUoJy4uLy4uLy4uL3NyYy9jb21tb24vdXRpbHMnKTtcbiAgICAgIGNvbnN0IG1vY2tQREZQcm94eSA9IHsgbnVtUGFnZXM6IDMgfTtcbiAgICAgIGNvbnN0IHBkZkJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB7IHZlcmJvc2l0eTogMSB9O1xuICAgICAgXG4gICAgICBsb2FkUERGU2FmZWx5Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQREZQcm94eSk7XG5cbiAgICAgIGF3YWl0IHBkZlNlcnZpY2UubG9hZFBERihwZGZCeXRlcywgb3B0aW9ucyk7XG5cbiAgICAgIGV4cGVjdChsb2FkUERGU2FmZWx5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwZGZCeXRlcywgb3B0aW9ucyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsb2FkaW5nIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbG9hZFBERlNhZmVseSB9ID0gcmVxdWlyZSgnLi4vLi4vLi4vc3JjL2NvbW1vbi91dGlscycpO1xuICAgICAgY29uc3QgbG9hZEVycm9yID0gbmV3IEVycm9yKCdMb2FkIGZhaWxlZCcpO1xuICAgICAgY29uc3QgcGRmQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgXG4gICAgICBsb2FkUERGU2FmZWx5Lm1vY2tSZWplY3RlZFZhbHVlKGxvYWRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChwZGZTZXJ2aWNlLmxvYWRQREYocGRmQnl0ZXMpKS5yZWplY3RzLnRvVGhyb3coJ0xvYWQgZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVQREYnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgbmV3IGVtcHR5IFBERiBkb2N1bWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tOZXdEb2MgPSB7IC4uLm1vY2tQREZEb2N1bWVudCB9O1xuICAgICAgKFBERkRvY3VtZW50LmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tOZXdEb2MpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwZGZTZXJ2aWNlLmNyZWF0ZVBERigpO1xuXG4gICAgICBleHBlY3QoUERGRG9jdW1lbnQuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKG1vY2tOZXdEb2MpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY3JlYXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlRXJyb3IgPSBuZXcgRXJyb3IoJ0NyZWF0aW9uIGZhaWxlZCcpO1xuICAgICAgKFBERkRvY3VtZW50LmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKGNyZWF0ZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHBkZlNlcnZpY2UuY3JlYXRlUERGKCkpLnJlamVjdHMudG9UaHJvdygnQ3JlYXRpb24gZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdtZXJnZVBERnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBtZXJnZSBtdWx0aXBsZSBQREYgYnVmZmVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBkZkJ1ZmZlcjEgPSBuZXcgVWludDhBcnJheShbMSwgMiwgM10pO1xuICAgICAgY29uc3QgcGRmQnVmZmVyMiA9IG5ldyBVaW50OEFycmF5KFs0LCA1LCA2XSk7XG4gICAgICBjb25zdCBwZGZCdWZmZXJzID0gW3BkZkJ1ZmZlcjEsIHBkZkJ1ZmZlcjJdO1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrRG9jMSA9IHsgLi4ubW9ja1BERkRvY3VtZW50LCBnZXRQYWdlQ291bnQ6ICgpID0+IDIsIGdldFBhZ2VzOiAoKSA9PiBbJ3BhZ2UxJywgJ3BhZ2UyJ10gfTtcbiAgICAgIGNvbnN0IG1vY2tEb2MyID0geyAuLi5tb2NrUERGRG9jdW1lbnQsIGdldFBhZ2VDb3VudDogKCkgPT4gMSwgZ2V0UGFnZXM6ICgpID0+IFsncGFnZTMnXSB9O1xuICAgICAgY29uc3QgbW9ja01lcmdlZERvYyA9IHsgXG4gICAgICAgIC4uLm1vY2tQREZEb2N1bWVudCwgXG4gICAgICAgIGNvcHlQYWdlczogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFsnY29waWVkUGFnZTEnLCAnY29waWVkUGFnZTInLCAnY29waWVkUGFnZTMnXSksXG4gICAgICAgIGFkZFBhZ2U6IGplc3QuZm4oKVxuICAgICAgfTtcblxuICAgICAgKFBERkRvY3VtZW50LmxvYWQgYXMgamVzdC5Nb2NrKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tEb2MxKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tEb2MyKTtcbiAgICAgIChQREZEb2N1bWVudC5jcmVhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrTWVyZ2VkRG9jKTtcbiAgICAgIFxuICAgICAgY29uc3QgbWVyZ2VkQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNSwgNl0pO1xuICAgICAgbW9ja01lcmdlZERvYy5zYXZlLm1vY2tSZXNvbHZlZFZhbHVlKG1lcmdlZEJ5dGVzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGRmU2VydmljZS5tZXJnZVBERnMocGRmQnVmZmVycyk7XG5cbiAgICAgIGV4cGVjdChQREZEb2N1bWVudC5sb2FkKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICBleHBlY3QoUERGRG9jdW1lbnQuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja01lcmdlZERvYy5jb3B5UGFnZXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUobWVyZ2VkQnl0ZXMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWVyZ2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGRmQnVmZmVycyA9IFtuZXcgVWludDhBcnJheShbMSwgMiwgM10pXTtcbiAgICAgIGNvbnN0IGxvYWRFcnJvciA9IG5ldyBFcnJvcignTG9hZCBmYWlsZWQnKTtcbiAgICAgIFxuICAgICAgKFBERkRvY3VtZW50LmxvYWQgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShsb2FkRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocGRmU2VydmljZS5tZXJnZVBERnMocGRmQnVmZmVycykpLnJlamVjdHMudG9UaHJvdygnTG9hZCBmYWlsZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGJ1ZmZlcnMgYXJyYXknLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBleHBlY3QocGRmU2VydmljZS5tZXJnZVBERnMoW10pKS5yZWplY3RzLnRvVGhyb3coKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NwbGl0UERGJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3BsaXQgUERGIGF0IHNwZWNpZmllZCBwYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGRmQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgY29uc3Qgc3BsaXRQYWdlID0gMztcbiAgICAgIFxuICAgICAgY29uc3QgbW9ja1NvdXJjZURvYyA9IHtcbiAgICAgICAgLi4ubW9ja1BERkRvY3VtZW50LFxuICAgICAgICBnZXRQYWdlQ291bnQ6ICgpID0+IDUsXG4gICAgICAgIGdldFBhZ2VzOiAoKSA9PiBbJ3AxJywgJ3AyJywgJ3AzJywgJ3A0JywgJ3A1J11cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tGaXJzdERvYyA9IHsgXG4gICAgICAgIC4uLm1vY2tQREZEb2N1bWVudCxcbiAgICAgICAgY29weVBhZ2VzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoWydwMScsICdwMicsICdwMyddKSxcbiAgICAgICAgYWRkUGFnZTogamVzdC5mbigpLFxuICAgICAgICBzYXZlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDNdKSlcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tTZWNvbmREb2MgPSB7IFxuICAgICAgICAuLi5tb2NrUERGRG9jdW1lbnQsXG4gICAgICAgIGNvcHlQYWdlczogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFsncDQnLCAncDUnXSksXG4gICAgICAgIGFkZFBhZ2U6IGplc3QuZm4oKSxcbiAgICAgICAgc2F2ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG5ldyBVaW50OEFycmF5KFs0LCA1XSkpXG4gICAgICB9O1xuXG4gICAgICAoUERGRG9jdW1lbnQubG9hZCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTb3VyY2VEb2MpO1xuICAgICAgKFBERkRvY3VtZW50LmNyZWF0ZSBhcyBqZXN0Lk1vY2spXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja0ZpcnN0RG9jKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tTZWNvbmREb2MpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwZGZTZXJ2aWNlLnNwbGl0UERGKHBkZkJ5dGVzLCBzcGxpdFBhZ2UpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmZpcnN0KS50b0VxdWFsKG5ldyBVaW50OEFycmF5KFsxLCAyLCAzXSkpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zZWNvbmQpLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzQsIDVdKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHNwbGl0IHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwZGZCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBjb25zdCBtb2NrU291cmNlRG9jID0geyBnZXRQYWdlQ291bnQ6ICgpID0+IDUgfTtcbiAgICAgIFxuICAgICAgKFBERkRvY3VtZW50LmxvYWQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU291cmNlRG9jKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHBkZlNlcnZpY2Uuc3BsaXRQREYocGRmQnl0ZXMsIDApKS5yZWplY3RzLnRvVGhyb3coJ0ludmFsaWQgc3BsaXQgcGFnZScpO1xuICAgICAgYXdhaXQgZXhwZWN0KHBkZlNlcnZpY2Uuc3BsaXRQREYocGRmQnl0ZXMsIDYpKS5yZWplY3RzLnRvVGhyb3coJ0ludmFsaWQgc3BsaXQgcGFnZScpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG4vLyBDbGVhbiB1cCBhZnRlciB0ZXN0c1xuYWZ0ZXJBbGwoKCkgPT4ge1xuICBqZXN0LnJlc3RvcmVBbGxNb2NrcygpO1xufSk7Il0sInZlcnNpb24iOjN9