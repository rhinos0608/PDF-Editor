93cd364bab53a5160b0a0410f463614c
"use strict";
/**
 * Unit tests for PDFService
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// Mock external dependencies
jest.mock('pdfjs-dist', () => ({
    GlobalWorkerOptions: {
        workerSrc: ''
    },
    getDocument: jest.fn()
}));
jest.mock('pdf-lib', () => ({
    PDFDocument: {
        create: jest.fn(),
        load: jest.fn()
    },
    rgb: jest.fn(() => ({ r: 1, g: 0, b: 0 })),
    StandardFonts: {
        Helvetica: 'Helvetica'
    },
    degrees: jest.fn((deg) => deg * Math.PI / 180)
}));
// Mock common utils
jest.mock('../../../src/common/utils', () => ({
    loadPDFSafely: jest.fn(),
    validatePDFBytes: jest.fn(() => true),
    createSafePDFBytes: jest.fn((bytes) => new Uint8Array(bytes))
}));
const PDFService_1 = require("../../../src/renderer/services/PDFService");
const pdf_lib_1 = require("pdf-lib");
const pdfjsLib = __importStar(require("pdfjs-dist"));
describe('PDFService', () => {
    let pdfService;
    let mockPDFDocument;
    beforeEach(() => {
        pdfService = new PDFService_1.PDFService();
        // Create mock PDF document
        mockPDFDocument = {
            save: jest.fn().mockResolvedValue(new Uint8Array([1, 2, 3, 4])),
            getPageCount: jest.fn().mockReturnValue(5),
            addPage: jest.fn(),
            removePage: jest.fn(),
            getPages: jest.fn().mockReturnValue([]),
            getTitle: jest.fn().mockReturnValue('Test PDF'),
            setTitle: jest.fn(),
            getAuthor: jest.fn().mockReturnValue('Test Author'),
            setAuthor: jest.fn(),
            getSubject: jest.fn().mockReturnValue('Test Subject'),
            setSubject: jest.fn(),
            getKeywords: jest.fn().mockReturnValue(['test', 'pdf']),
            setKeywords: jest.fn(),
            getCreator: jest.fn().mockReturnValue('Test Creator'),
            setCreator: jest.fn(),
            getProducer: jest.fn().mockReturnValue('Test Producer'),
            setProducer: jest.fn(),
            getCreationDate: jest.fn().mockReturnValue(new Date('2024-01-01')),
            setCreationDate: jest.fn(),
            getModificationDate: jest.fn().mockReturnValue(new Date('2024-01-02')),
            setModificationDate: jest.fn()
        };
        jest.clearAllMocks();
    });
    describe('Constructor', () => {
        it('should initialize with empty state', () => {
            const service = new PDFService_1.PDFService();
            expect(() => service.getCurrentPDF()).toThrow('No PDF document is currently loaded');
        });
        it('should warn if PDF.js worker is not configured', () => {
            const consoleSpy = jest.spyOn(console, 'warn').mockImplementation();
            pdfjsLib.GlobalWorkerOptions.workerSrc = '';
            new PDFService_1.PDFService();
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('PDF.js worker not configured'));
            consoleSpy.mockRestore();
        });
    });
    describe('setCurrentPDF', () => {
        it('should set current PDF with safe bytes', () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(pdfService.getCurrentPDF()).toBe(mockPDFDocument);
            expect(pdfService.hasUnsavedChanges()).toBe(false);
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('Current PDF set with safe byte tracking'));
            consoleSpy.mockRestore();
        });
        it('should create safe copy of original bytes', () => {
            const { createSafePDFBytes } = require('../../../src/common/utils');
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(createSafePDFBytes).toHaveBeenCalledWith(originalBytes);
        });
    });
    describe('getCurrentPDF', () => {
        it('should return current PDF when set', () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(pdfService.getCurrentPDF()).toBe(mockPDFDocument);
        });
        it('should throw error when no PDF is loaded', () => {
            expect(() => pdfService.getCurrentPDF()).toThrow('No PDF document is currently loaded');
        });
    });
    describe('markModified', () => {
        it('should mark PDF as modified', () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            expect(pdfService.hasUnsavedChanges()).toBe(false);
            pdfService.markModified();
            expect(pdfService.hasUnsavedChanges()).toBe(true);
        });
    });
    describe('saveCurrentPDF', () => {
        it('should save current PDF and return bytes', async () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const savedBytes = new Uint8Array([5, 4, 3, 2, 1]);
            mockPDFDocument.save.mockResolvedValue(savedBytes);
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            const result = await pdfService.saveCurrentPDF();
            expect(mockPDFDocument.save).toHaveBeenCalled();
            expect(result).toEqual(savedBytes);
            expect(pdfService.hasUnsavedChanges()).toBe(false); // Should reset modified flag
        });
        it('should throw error when no PDF is loaded', async () => {
            await expect(pdfService.saveCurrentPDF()).rejects.toThrow('No PDF document to save');
        });
        it('should handle save errors gracefully', async () => {
            const originalBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const saveError = new Error('Save failed');
            mockPDFDocument.save.mockRejectedValueOnce(saveError) // First attempt fails
                .mockRejectedValueOnce(saveError) // Second attempt fails
                .mockRejectedValueOnce(saveError); // Third attempt fails
            pdfService.setCurrentPDF(mockPDFDocument, originalBytes);
            await expect(pdfService.saveCurrentPDF()).rejects.toThrow(expect.stringContaining('Failed to save PDF after 3 attempts: Save failed'));
        });
    });
    describe('loadPDF', () => {
        it('should load PDF from bytes', async () => {
            const { loadPDFSafely } = require('../../../src/common/utils');
            const mockPDFProxy = { numPages: 3 };
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            loadPDFSafely.mockResolvedValue(mockPDFProxy);
            const result = await pdfService.loadPDF(pdfBytes);
            expect(loadPDFSafely).toHaveBeenCalledWith(pdfBytes, undefined);
            expect(result).toBe(mockPDFProxy);
        });
        it('should pass options to loadPDFSafely', async () => {
            const { loadPDFSafely } = require('../../../src/common/utils');
            const mockPDFProxy = { numPages: 3 };
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const options = { verbosity: 1 };
            loadPDFSafely.mockResolvedValue(mockPDFProxy);
            await pdfService.loadPDF(pdfBytes, options);
            expect(loadPDFSafely).toHaveBeenCalledWith(pdfBytes, options);
        });
        it('should handle loading errors', async () => {
            const { loadPDFSafely } = require('../../../src/common/utils');
            const loadError = new Error('Load failed');
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            loadPDFSafely.mockRejectedValue(loadError);
            await expect(pdfService.loadPDF(pdfBytes)).rejects.toThrow('Load failed');
        });
    });
    describe('createPDF', () => {
        it('should create new empty PDF document', async () => {
            const mockNewDoc = { ...mockPDFDocument };
            pdf_lib_1.PDFDocument.create.mockResolvedValue(mockNewDoc);
            const result = await pdfService.createPDF();
            expect(pdf_lib_1.PDFDocument.create).toHaveBeenCalled();
            expect(result).toBe(mockNewDoc);
        });
        it('should handle creation errors', async () => {
            const createError = new Error('Creation failed');
            pdf_lib_1.PDFDocument.create.mockRejectedValue(createError);
            await expect(pdfService.createPDF()).rejects.toThrow('Creation failed');
        });
    });
    describe('mergePDFs', () => {
        it('should merge multiple PDF buffers', async () => {
            const pdfBuffer1 = new Uint8Array([1, 2, 3]);
            const pdfBuffer2 = new Uint8Array([4, 5, 6]);
            const pdfBuffers = [pdfBuffer1, pdfBuffer2];
            const mockDoc1 = { ...mockPDFDocument, getPageCount: () => 2, getPages: () => ['page1', 'page2'] };
            const mockDoc2 = { ...mockPDFDocument, getPageCount: () => 1, getPages: () => ['page3'] };
            const mockMergedDoc = {
                ...mockPDFDocument,
                copyPages: jest.fn().mockResolvedValue(['copiedPage1', 'copiedPage2', 'copiedPage3']),
                addPage: jest.fn()
            };
            pdf_lib_1.PDFDocument.load
                .mockResolvedValueOnce(mockDoc1)
                .mockResolvedValueOnce(mockDoc2);
            pdf_lib_1.PDFDocument.create.mockResolvedValue(mockMergedDoc);
            const mergedBytes = new Uint8Array([1, 2, 3, 4, 5, 6]);
            mockMergedDoc.save.mockResolvedValue(mergedBytes);
            const result = await pdfService.mergePDFs(pdfBuffers);
            expect(pdf_lib_1.PDFDocument.load).toHaveBeenCalledTimes(2);
            expect(pdf_lib_1.PDFDocument.create).toHaveBeenCalled();
            expect(mockMergedDoc.copyPages).toHaveBeenCalledTimes(2);
            expect(result).toBe(mergedBytes);
        });
        it('should handle merge errors', async () => {
            const pdfBuffers = [new Uint8Array([1, 2, 3])];
            const loadError = new Error('Load failed');
            pdf_lib_1.PDFDocument.load.mockRejectedValue(loadError);
            await expect(pdfService.mergePDFs(pdfBuffers)).rejects.toThrow('Load failed');
        });
        it('should handle empty buffers array', async () => {
            await expect(pdfService.mergePDFs([])).rejects.toThrow();
        });
    });
    describe('splitPDF', () => {
        it('should split PDF at specified page', async () => {
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const splitPage = 3;
            const mockSourceDoc = {
                ...mockPDFDocument,
                getPageCount: () => 5,
                getPages: () => ['p1', 'p2', 'p3', 'p4', 'p5']
            };
            const mockFirstDoc = {
                ...mockPDFDocument,
                copyPages: jest.fn().mockResolvedValue(['p1', 'p2', 'p3']),
                addPage: jest.fn(),
                save: jest.fn().mockResolvedValue(new Uint8Array([1, 2, 3]))
            };
            const mockSecondDoc = {
                ...mockPDFDocument,
                copyPages: jest.fn().mockResolvedValue(['p4', 'p5']),
                addPage: jest.fn(),
                save: jest.fn().mockResolvedValue(new Uint8Array([4, 5]))
            };
            pdf_lib_1.PDFDocument.load.mockResolvedValue(mockSourceDoc);
            pdf_lib_1.PDFDocument.create
                .mockResolvedValueOnce(mockFirstDoc)
                .mockResolvedValueOnce(mockSecondDoc);
            const result = await pdfService.splitPDF(pdfBytes, splitPage);
            expect(result.first).toEqual(new Uint8Array([1, 2, 3]));
            expect(result.second).toEqual(new Uint8Array([4, 5]));
        });
        it('should handle invalid split page', async () => {
            const pdfBytes = new Uint8Array([1, 2, 3, 4, 5]);
            const mockSourceDoc = { getPageCount: () => 5 };
            pdf_lib_1.PDFDocument.load.mockResolvedValue(mockSourceDoc);
            await expect(pdfService.splitPDF(pdfBytes, 0)).rejects.toThrow('Invalid split page');
            await expect(pdfService.splitPDF(pdfBytes, 6)).rejects.toThrow('Invalid split page');
        });
    });
});
// Clean up after tests
afterAll(() => {
    jest.restoreAllMocks();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBZG1pblxcRG9jdW1lbnRzXFxSU1RcXFBERiBFZGl0b3JcXF9fdGVzdHNfX1xccmVuZGVyZXJcXHNlcnZpY2VzXFxQREZTZXJ2aWNlLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU1ILDZCQUE2QjtBQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzdCLG1CQUFtQixFQUFFO1FBQ25CLFNBQVMsRUFBRSxFQUFFO0tBQ2Q7SUFDRCxXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN2QixDQUFDLENBQUMsQ0FBQztBQUVKLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDMUIsV0FBVyxFQUFFO1FBQ1gsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDaEI7SUFDRCxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLGFBQWEsRUFBRTtRQUNiLFNBQVMsRUFBRSxXQUFXO0tBQ3ZCO0lBQ0QsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsQ0FBQztDQUN2RCxDQUFDLENBQUMsQ0FBQztBQUVKLG9CQUFvQjtBQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDNUMsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDeEIsZ0JBQWdCLEVBQUUsSUFB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RSxDQUFDLGtDQUFrQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2hELE1BQU0sUUFBUSxHQUFHLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakQsTUFBTSxhQUFhLEdBQUcsRUFBRSxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFFL0MscUJBQVcsQ0FBQyxJQUFrQixDQUFDLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRWpFLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ3JGLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBQ3ZGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILHVCQUF1QjtBQUN2QixRQUFRLENBQUMsR0FBRyxFQUFFO0lBQ1osSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0FBQ3pCLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWRtaW5cXERvY3VtZW50c1xcUlNUXFxQREYgRWRpdG9yXFxfX3Rlc3RzX19cXHJlbmRlcmVyXFxzZXJ2aWNlc1xcUERGU2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVW5pdCB0ZXN0cyBmb3IgUERGU2VydmljZVxuICovXG5cbmltcG9ydCB7IFBERlNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9zcmMvcmVuZGVyZXIvc2VydmljZXMvUERGU2VydmljZSc7XG5pbXBvcnQgeyBQREZEb2N1bWVudCB9IGZyb20gJ3BkZi1saWInO1xuaW1wb3J0ICogYXMgcGRmanNMaWIgZnJvbSAncGRmanMtZGlzdCc7XG5cbi8vIE1vY2sgZXh0ZXJuYWwgZGVwZW5kZW5jaWVzXG5qZXN0Lm1vY2soJ3BkZmpzLWRpc3QnLCAoKSA9PiAoe1xuICBHbG9iYWxXb3JrZXJPcHRpb25zOiB7XG4gICAgd29ya2VyU3JjOiAnJ1xuICB9LFxuICBnZXREb2N1bWVudDogamVzdC5mbigpXG59KSk7XG5cbmplc3QubW9jaygncGRmLWxpYicsICgpID0+ICh7XG4gIFBERkRvY3VtZW50OiB7XG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgbG9hZDogamVzdC5mbigpXG4gIH0sXG4gIHJnYjogamVzdC5mbigoKSA9PiAoeyByOiAxLCBnOiAwLCBiOiAwIH0pKSxcbiAgU3RhbmRhcmRGb250czoge1xuICAgIEhlbHZldGljYTogJ0hlbHZldGljYSdcbiAgfSxcbiAgZGVncmVlczogamVzdC5mbigoZGVnOiBudW1iZXIpID0+IGRlZyAqIE1hdGguUEkgLyAxODApXG59KSk7XG5cbi8vIE1vY2sgY29tbW9uIHV0aWxzXG5qZXN0Lm1vY2soJy4uLy4uLy4uL3NyYy9jb21tb24vdXRpbHMnLCAoKSA9PiAoe1xuICBsb2FkUERGU2FmZWx5OiBqZXN0LmZuKCksXG4gIHZhbGlkYXRlUERGQnl0ZXM6IGplc3QuZm4oKCkgPT4gdHJ1ZSksXG4gIGNyZWF0ZVNhZmVQREZCeXRlczogamVzdC5mbigoYnl0ZXM6IFVpbnQ4QXJyYXkpID0+IG5ldyBVaW50OEFycmF5KGJ5dGVzKSlcbn0pKTtcblxuZGVzY3JpYmUoJ1BERlNlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCBwZGZTZXJ2aWNlOiBQREZTZXJ2aWNlO1xuICBsZXQgbW9ja1BERkRvY3VtZW50OiBqZXN0Lk1vY2tlZDxQREZEb2N1bWVudD47XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgcGRmU2VydmljZSA9IG5ldyBQREZTZXJ2aWNlKCk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIG1vY2sgUERGIGRvY3VtZW50XG4gICAgbW9ja1BERkRvY3VtZW50ID0ge1xuICAgICAgc2F2ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0XSkpLFxuICAgICAgZ2V0UGFnZUNvdW50OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKDUpLFxuICAgICAgYWRkUGFnZTogamVzdC5mbigpLFxuICAgICAgcmVtb3ZlUGFnZTogamVzdC5mbigpLFxuICAgICAgZ2V0UGFnZXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoW10pLFxuICAgICAgZ2V0VGl0bGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3QgUERGJyksXG4gICAgICBzZXRUaXRsZTogamVzdC5mbigpLFxuICAgICAgZ2V0QXV0aG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdUZXN0IEF1dGhvcicpLFxuICAgICAgc2V0QXV0aG9yOiBqZXN0LmZuKCksXG4gICAgICBnZXRTdWJqZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdUZXN0IFN1YmplY3QnKSxcbiAgICAgIHNldFN1YmplY3Q6IGplc3QuZm4oKSxcbiAgICAgIGdldEtleXdvcmRzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKFsndGVzdCcsICdwZGYnXSksXG4gICAgICBzZXRLZXl3b3JkczogamVzdC5mbigpLFxuICAgICAgZ2V0Q3JlYXRvcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBDcmVhdG9yJyksXG4gICAgICBzZXRDcmVhdG9yOiBqZXN0LmZuKCksXG4gICAgICBnZXRQcm9kdWNlcjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBQcm9kdWNlcicpLFxuICAgICAgc2V0UHJvZHVjZXI6IGplc3QuZm4oKSxcbiAgICAgIGdldENyZWF0aW9uRGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShuZXcgRGF0ZSgnMjAyNC0wMS0wMScpKSxcbiAgICAgIHNldENyZWF0aW9uRGF0ZTogamVzdC5mbigpLFxuICAgICAgZ2V0TW9kaWZpY2F0aW9uRGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShuZXcgRGF0ZSgnMjAyNC0wMS0wMicpKSxcbiAgICAgIHNldE1vZGlmaWNhdGlvbkRhdGU6IGplc3QuZm4oKVxuICAgIH0gYXMgYW55O1xuXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb25zdHJ1Y3RvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgd2l0aCBlbXB0eSBzdGF0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgUERGU2VydmljZSgpO1xuICAgICAgZXhwZWN0KCgpID0+IHNlcnZpY2UuZ2V0Q3VycmVudFBERigpKS50b1Rocm93KCdObyBQREYgZG9jdW1lbnQgaXMgY3VycmVudGx5IGxvYWRlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB3YXJuIGlmIFBERi5qcyB3b3JrZXIgaXMgbm90IGNvbmZpZ3VyZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25zb2xlU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnd2FybicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgKHBkZmpzTGliLkdsb2JhbFdvcmtlck9wdGlvbnMgYXMgYW55KS53b3JrZXJTcmMgPSAnJztcbiAgICAgIFxuICAgICAgbmV3IFBERlNlcnZpY2UoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdQREYuanMgd29ya2VyIG5vdCBjb25maWd1cmVkJykpO1xuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc2V0Q3VycmVudFBERicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNldCBjdXJyZW50IFBERiB3aXRoIHNhZmUgYnl0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcmlnaW5hbEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdsb2cnKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcblxuICAgICAgcGRmU2VydmljZS5zZXRDdXJyZW50UERGKG1vY2tQREZEb2N1bWVudCwgb3JpZ2luYWxCeXRlcyk7XG5cbiAgICAgIGV4cGVjdChwZGZTZXJ2aWNlLmdldEN1cnJlbnRQREYoKSkudG9CZShtb2NrUERGRG9jdW1lbnQpO1xuICAgICAgZXhwZWN0KHBkZlNlcnZpY2UuaGFzVW5zYXZlZENoYW5nZXMoKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0N1cnJlbnQgUERGIHNldCB3aXRoIHNhZmUgYnl0ZSB0cmFja2luZycpKTtcbiAgICAgIFxuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgc2FmZSBjb3B5IG9mIG9yaWdpbmFsIGJ5dGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyBjcmVhdGVTYWZlUERGQnl0ZXMgfSA9IHJlcXVpcmUoJy4uLy4uLy4uL3NyYy9jb21tb24vdXRpbHMnKTtcbiAgICAgIGNvbnN0IG9yaWdpbmFsQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuXG4gICAgICBwZGZTZXJ2aWNlLnNldEN1cnJlbnRQREYobW9ja1BERkRvY3VtZW50LCBvcmlnaW5hbEJ5dGVzKTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZVNhZmVQREZCeXRlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgob3JpZ2luYWxCeXRlcyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRDdXJyZW50UERGJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGN1cnJlbnQgUERGIHdoZW4gc2V0JywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luYWxCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBwZGZTZXJ2aWNlLnNldEN1cnJlbnRQREYobW9ja1BERkRvY3VtZW50LCBvcmlnaW5hbEJ5dGVzKTtcblxuICAgICAgZXhwZWN0KHBkZlNlcnZpY2UuZ2V0Q3VycmVudFBERigpKS50b0JlKG1vY2tQREZEb2N1bWVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gbm8gUERGIGlzIGxvYWRlZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiBwZGZTZXJ2aWNlLmdldEN1cnJlbnRQREYoKSkudG9UaHJvdygnTm8gUERGIGRvY3VtZW50IGlzIGN1cnJlbnRseSBsb2FkZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ21hcmtNb2RpZmllZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG1hcmsgUERGIGFzIG1vZGlmaWVkJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luYWxCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBwZGZTZXJ2aWNlLnNldEN1cnJlbnRQREYobW9ja1BERkRvY3VtZW50LCBvcmlnaW5hbEJ5dGVzKTtcblxuICAgICAgZXhwZWN0KHBkZlNlcnZpY2UuaGFzVW5zYXZlZENoYW5nZXMoKSkudG9CZShmYWxzZSk7XG4gICAgICBcbiAgICAgIHBkZlNlcnZpY2UubWFya01vZGlmaWVkKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChwZGZTZXJ2aWNlLmhhc1Vuc2F2ZWRDaGFuZ2VzKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzYXZlQ3VycmVudFBERicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNhdmUgY3VycmVudCBQREYgYW5kIHJldHVybiBieXRlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgY29uc3Qgc2F2ZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KFs1LCA0LCAzLCAyLCAxXSk7XG4gICAgICBcbiAgICAgIG1vY2tQREZEb2N1bWVudC5zYXZlLm1vY2tSZXNvbHZlZFZhbHVlKHNhdmVkQnl0ZXMpO1xuICAgICAgcGRmU2VydmljZS5zZXRDdXJyZW50UERGKG1vY2tQREZEb2N1bWVudCwgb3JpZ2luYWxCeXRlcyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBkZlNlcnZpY2Uuc2F2ZUN1cnJlbnRQREYoKTtcblxuICAgICAgZXhwZWN0KG1vY2tQREZEb2N1bWVudC5zYXZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHNhdmVkQnl0ZXMpO1xuICAgICAgZXhwZWN0KHBkZlNlcnZpY2UuaGFzVW5zYXZlZENoYW5nZXMoKSkudG9CZShmYWxzZSk7IC8vIFNob3VsZCByZXNldCBtb2RpZmllZCBmbGFnXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gbm8gUERGIGlzIGxvYWRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChwZGZTZXJ2aWNlLnNhdmVDdXJyZW50UERGKCkpLnJlamVjdHMudG9UaHJvdygnTm8gUERGIGRvY3VtZW50IHRvIHNhdmUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNhdmUgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvcmlnaW5hbEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIGNvbnN0IHNhdmVFcnJvciA9IG5ldyBFcnJvcignU2F2ZSBmYWlsZWQnKTtcbiAgICAgIFxuICAgICAgbW9ja1BERkRvY3VtZW50LnNhdmUubW9ja1JlamVjdGVkVmFsdWVPbmNlKHNhdmVFcnJvcikgLy8gRmlyc3QgYXR0ZW1wdCBmYWlsc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1vY2tSZWplY3RlZFZhbHVlT25jZShzYXZlRXJyb3IpIC8vIFNlY29uZCBhdHRlbXB0IGZhaWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAubW9ja1JlamVjdGVkVmFsdWVPbmNlKHNhdmVFcnJvcik7IC8vIFRoaXJkIGF0dGVtcHQgZmFpbHNcbiAgICAgIHBkZlNlcnZpY2Uuc2V0Q3VycmVudFBERihtb2NrUERGRG9jdW1lbnQsIG9yaWdpbmFsQnl0ZXMpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocGRmU2VydmljZS5zYXZlQ3VycmVudFBERigpKS5yZWplY3RzLnRvVGhyb3coZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0ZhaWxlZCB0byBzYXZlIFBERiBhZnRlciAzIGF0dGVtcHRzOiBTYXZlIGZhaWxlZCcpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xvYWRQREYnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBsb2FkIFBERiBmcm9tIGJ5dGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyBsb2FkUERGU2FmZWx5IH0gPSByZXF1aXJlKCcuLi8uLi8uLi9zcmMvY29tbW9uL3V0aWxzJyk7XG4gICAgICBjb25zdCBtb2NrUERGUHJveHkgPSB7IG51bVBhZ2VzOiAzIH07XG4gICAgICBjb25zdCBwZGZCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBcbiAgICAgIGxvYWRQREZTYWZlbHkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BERlByb3h5KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGRmU2VydmljZS5sb2FkUERGKHBkZkJ5dGVzKTtcblxuICAgICAgZXhwZWN0KGxvYWRQREZTYWZlbHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBkZkJ5dGVzLCB1bmRlZmluZWQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShtb2NrUERGUHJveHkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwYXNzIG9wdGlvbnMgdG8gbG9hZFBERlNhZmVseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbG9hZFBERlNhZmVseSB9ID0gcmVxdWlyZSgnLi4vLi4vLi4vc3JjL2NvbW1vbi91dGlscycpO1xuICAgICAgY29uc3QgbW9ja1BERlByb3h5ID0geyBudW1QYWdlczogMyB9O1xuICAgICAgY29uc3QgcGRmQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMSwgMiwgMywgNCwgNV0pO1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgdmVyYm9zaXR5OiAxIH07XG4gICAgICBcbiAgICAgIGxvYWRQREZTYWZlbHkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BERlByb3h5KTtcblxuICAgICAgYXdhaXQgcGRmU2VydmljZS5sb2FkUERGKHBkZkJ5dGVzLCBvcHRpb25zKTtcblxuICAgICAgZXhwZWN0KGxvYWRQREZTYWZlbHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBkZkJ5dGVzLCBvcHRpb25zKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGxvYWRpbmcgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyBsb2FkUERGU2FmZWx5IH0gPSByZXF1aXJlKCcuLi8uLi8uLi9zcmMvY29tbW9uL3V0aWxzJyk7XG4gICAgICBjb25zdCBsb2FkRXJyb3IgPSBuZXcgRXJyb3IoJ0xvYWQgZmFpbGVkJyk7XG4gICAgICBjb25zdCBwZGZCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBcbiAgICAgIGxvYWRQREZTYWZlbHkubW9ja1JlamVjdGVkVmFsdWUobG9hZEVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHBkZlNlcnZpY2UubG9hZFBERihwZGZCeXRlcykpLnJlamVjdHMudG9UaHJvdygnTG9hZCBmYWlsZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NyZWF0ZVBERicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBuZXcgZW1wdHkgUERGIGRvY3VtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja05ld0RvYyA9IHsgLi4ubW9ja1BERkRvY3VtZW50IH07XG4gICAgICAoUERGRG9jdW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja05ld0RvYyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBkZlNlcnZpY2UuY3JlYXRlUERGKCk7XG5cbiAgICAgIGV4cGVjdChQREZEb2N1bWVudC5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUobW9ja05ld0RvYyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjcmVhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVFcnJvciA9IG5ldyBFcnJvcignQ3JlYXRpb24gZmFpbGVkJyk7XG4gICAgICAoUERGRG9jdW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUoY3JlYXRlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocGRmU2VydmljZS5jcmVhdGVQREYoKSkucmVqZWN0cy50b1Rocm93KCdDcmVhdGlvbiBmYWlsZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ21lcmdlUERGcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG1lcmdlIG11bHRpcGxlIFBERiBidWZmZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGRmQnVmZmVyMSA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzXSk7XG4gICAgICBjb25zdCBwZGZCdWZmZXIyID0gbmV3IFVpbnQ4QXJyYXkoWzQsIDUsIDZdKTtcbiAgICAgIGNvbnN0IHBkZkJ1ZmZlcnMgPSBbcGRmQnVmZmVyMSwgcGRmQnVmZmVyMl07XG4gICAgICBcbiAgICAgIGNvbnN0IG1vY2tEb2MxID0geyAuLi5tb2NrUERGRG9jdW1lbnQsIGdldFBhZ2VDb3VudDogKCkgPT4gMiwgZ2V0UGFnZXM6ICgpID0+IFsncGFnZTEnLCAncGFnZTInXSB9O1xuICAgICAgY29uc3QgbW9ja0RvYzIgPSB7IC4uLm1vY2tQREZEb2N1bWVudCwgZ2V0UGFnZUNvdW50OiAoKSA9PiAxLCBnZXRQYWdlczogKCkgPT4gWydwYWdlMyddIH07XG4gICAgICBjb25zdCBtb2NrTWVyZ2VkRG9jID0geyBcbiAgICAgICAgLi4ubW9ja1BERkRvY3VtZW50LCBcbiAgICAgICAgY29weVBhZ2VzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoWydjb3BpZWRQYWdlMScsICdjb3BpZWRQYWdlMicsICdjb3BpZWRQYWdlMyddKSxcbiAgICAgICAgYWRkUGFnZTogamVzdC5mbigpXG4gICAgICB9O1xuXG4gICAgICAoUERGRG9jdW1lbnQubG9hZCBhcyBqZXN0Lk1vY2spXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja0RvYzEpXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja0RvYzIpO1xuICAgICAgKFBERkRvY3VtZW50LmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tNZXJnZWREb2MpO1xuICAgICAgXG4gICAgICBjb25zdCBtZXJnZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1LCA2XSk7XG4gICAgICBtb2NrTWVyZ2VkRG9jLnNhdmUubW9ja1Jlc29sdmVkVmFsdWUobWVyZ2VkQnl0ZXMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwZGZTZXJ2aWNlLm1lcmdlUERGcyhwZGZCdWZmZXJzKTtcblxuICAgICAgZXhwZWN0KFBERkRvY3VtZW50LmxvYWQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdChQREZEb2N1bWVudC5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrTWVyZ2VkRG9jLmNvcHlQYWdlcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShtZXJnZWRCeXRlcyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtZXJnZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwZGZCdWZmZXJzID0gW25ldyBVaW50OEFycmF5KFsxLCAyLCAzXSldO1xuICAgICAgY29uc3QgbG9hZEVycm9yID0gbmV3IEVycm9yKCdMb2FkIGZhaWxlZCcpO1xuICAgICAgXG4gICAgICAoUERGRG9jdW1lbnQubG9hZCBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKGxvYWRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChwZGZTZXJ2aWNlLm1lcmdlUERGcyhwZGZCdWZmZXJzKSkucmVqZWN0cy50b1Rocm93KCdMb2FkIGZhaWxlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgYnVmZmVycyBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChwZGZTZXJ2aWNlLm1lcmdlUERGcyhbXSkpLnJlamVjdHMudG9UaHJvdygpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc3BsaXRQREYnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzcGxpdCBQREYgYXQgc3BlY2lmaWVkIHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwZGZCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxLCAyLCAzLCA0LCA1XSk7XG4gICAgICBjb25zdCBzcGxpdFBhZ2UgPSAzO1xuICAgICAgXG4gICAgICBjb25zdCBtb2NrU291cmNlRG9jID0ge1xuICAgICAgICAuLi5tb2NrUERGRG9jdW1lbnQsXG4gICAgICAgIGdldFBhZ2VDb3VudDogKCkgPT4gNSxcbiAgICAgICAgZ2V0UGFnZXM6ICgpID0+IFsncDEnLCAncDInLCAncDMnLCAncDQnLCAncDUnXVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgbW9ja0ZpcnN0RG9jID0geyBcbiAgICAgICAgLi4ubW9ja1BERkRvY3VtZW50LFxuICAgICAgICBjb3B5UGFnZXM6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShbJ3AxJywgJ3AyJywgJ3AzJ10pLFxuICAgICAgICBhZGRQYWdlOiBqZXN0LmZuKCksXG4gICAgICAgIHNhdmU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShuZXcgVWludDhBcnJheShbMSwgMiwgM10pKVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgbW9ja1NlY29uZERvYyA9IHsgXG4gICAgICAgIC4uLm1vY2tQREZEb2N1bWVudCxcbiAgICAgICAgY29weVBhZ2VzOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoWydwNCcsICdwNSddKSxcbiAgICAgICAgYWRkUGFnZTogamVzdC5mbigpLFxuICAgICAgICBzYXZlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobmV3IFVpbnQ4QXJyYXkoWzQsIDVdKSlcbiAgICAgIH07XG5cbiAgICAgIChQREZEb2N1bWVudC5sb2FkIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1NvdXJjZURvYyk7XG4gICAgICAoUERGRG9jdW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaylcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShtb2NrRmlyc3REb2MpXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1NlY29uZERvYyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBkZlNlcnZpY2Uuc3BsaXRQREYocGRmQnl0ZXMsIHNwbGl0UGFnZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZmlyc3QpLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDNdKSk7XG4gICAgICBleHBlY3QocmVzdWx0LnNlY29uZCkudG9FcXVhbChuZXcgVWludDhBcnJheShbNCwgNV0pKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgc3BsaXQgcGFnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBkZkJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIGNvbnN0IG1vY2tTb3VyY2VEb2MgPSB7IGdldFBhZ2VDb3VudDogKCkgPT4gNSB9O1xuICAgICAgXG4gICAgICAoUERGRG9jdW1lbnQubG9hZCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTb3VyY2VEb2MpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocGRmU2VydmljZS5zcGxpdFBERihwZGZCeXRlcywgMCkpLnJlamVjdHMudG9UaHJvdygnSW52YWxpZCBzcGxpdCBwYWdlJyk7XG4gICAgICBhd2FpdCBleHBlY3QocGRmU2VydmljZS5zcGxpdFBERihwZGZCeXRlcywgNikpLnJlamVjdHMudG9UaHJvdygnSW52YWxpZCBzcGxpdCBwYWdlJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbi8vIENsZWFuIHVwIGFmdGVyIHRlc3RzXG5hZnRlckFsbCgoKSA9PiB7XG4gIGplc3QucmVzdG9yZUFsbE1vY2tzKCk7XG59KTsiXSwidmVyc2lvbiI6M30=